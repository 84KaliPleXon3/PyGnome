

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Outputters &mdash; pyGNOME 0.5.0 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="pyGNOME 0.5.0 documentation" href="../index.html"/>
        <link rel="up" title="Scripting pygnome" href="../scripting.html"/>
        <link rel="next" title="Examples" href="scripting_examples.html"/>
        <link rel="prev" title="Weatherers" href="weatherers.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> pyGNOME
          

          
          </a>

          
            
            
              <div class="version">
                0.5
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../installing.html">Installing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../structure.html">GNOME Structure</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../scripting.html">Scripting pygnome</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="scripting_intro.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="utilities.html">Scripting utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="maps.html">Maps</a></li>
<li class="toctree-l2"><a class="reference internal" href="spills.html">Spills</a></li>
<li class="toctree-l2"><a class="reference internal" href="movers.html">Movers</a></li>
<li class="toctree-l2"><a class="reference internal" href="weatherers.html">Weatherers</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Outputters</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-outputter-api">The Outputter API</a></li>
<li class="toctree-l3"><a class="reference internal" href="#renderer">Renderer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#netcdf-output">NetCDF Output</a></li>
<li class="toctree-l3"><a class="reference internal" href="#kmz-output">KMZ Output</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="scripting_examples.html">Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../customizing.html">Customizing pygnome</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logging.html">The logging system</a></li>
<li class="toctree-l1"><a class="reference internal" href="../serialization.html">Notes on serialization / deserialization:</a></li>
<li class="toctree-l1"><a class="reference internal" href="../units.html">Units used in GNOME / PyGNOME</a></li>
<li class="toctree-l1"><a class="reference internal" href="../reference.html">PyGnome Class Reference</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyGNOME</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../scripting.html">Scripting pygnome</a> &raquo;</li>
        
      <li>Outputters</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/scripting/outputters.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

/* nice headers on first paragraph of info/warning boxes */
.admonition .first {
    margin: -12px;
    padding: 6px 12px;
    margin-bottom: 12px;
    color: #fff;
    line-height: 1;
    display: block;
}
.admonition.warning .first {
    background: #f0b37e;
}
.admonition.note .first {
    background: #6ab0de;
}
.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="outputters">
<h1>Outputters<a class="headerlink" href="#outputters" title="Permalink to this headline">¶</a></h1>
<p>Outputters allow us to save our model run results. Options include saving images, netcdf, kmlz, and geoJSON formats.</p>
<div class="section" id="the-outputter-api">
<h2>The Outputter API<a class="headerlink" href="#the-outputter-api" title="Permalink to this headline">¶</a></h2>
<p>Each outputter must be initialized a little differently, depending on its capabilities and intended use, but the general API is:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">Outputter</span><span class="p">(</span><span class="n">cache</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">on</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">output_timestep</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">output_zero_step</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">output_last_step</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
          <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</pre></div>
</div>
<p>The <code class="docutils literal"><span class="pre">cache</span></code> object is where the ouputtter will pull its data from &#8211; if not set, it automatically grabs the cache from the model when added to a model.</p>
<p><code class="docutils literal"><span class="pre">output_timestep</span></code> specifies when you want the output written &#8211; it defaults to every model timestep, but you may only want output every hour, or every 6 hours, or...</p>
<p><code class="docutils literal"><span class="pre">output_zero_timestep</span></code> specified whether you want the zeroth timestep (before any elements have been moved or altered) output</p>
<p><code class="docutils literal"><span class="pre">output_last_timestep</span></code> specifies whether you want the final timestep output, regardless of whether it lands on a the specified output_timestep.</p>
<p>See <code class="xref py py-class docutils literal"><span class="pre">gnome.outputters.Outputter</span></code> for the full API.</p>
</div>
<div class="section" id="renderer">
<h2>Renderer<a class="headerlink" href="#renderer" title="Permalink to this headline">¶</a></h2>
<p>For graphical (images) output we add a Renderer:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gnome.model</span> <span class="k">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">gnome.outputters</span> <span class="k">import</span> <span class="n">Renderer</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">timedelta</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="n">renderer</span> <span class="o">=</span> <span class="n">Renderer</span><span class="p">(</span><span class="n">mapfile</span><span class="o">=</span><span class="s2">&quot;the_map_bna&quot;</span><span class="p">,</span>
                    <span class="n">images_dir</span> <span class="o">=</span> <span class="s2">&quot;output&quot;</span><span class="p">,</span>
                    <span class="n">size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1280</span><span class="p">,</span><span class="mi">1024</span><span class="p">),</span>
                    <span class="n">output_timestep</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">outputters</span> <span class="o">+=</span> <span class="n">renderer</span>
</pre></div>
</div>
<p>See <code class="xref py py-class docutils literal"><span class="pre">gnome.outputters.Renderer</span></code> for some additional parameters that can be passed to the renderer.</p>
</div>
<div class="section" id="netcdf-output">
<h2>NetCDF Output<a class="headerlink" href="#netcdf-output" title="Permalink to this headline">¶</a></h2>
<p>To save particle information into a NetCDF file we use the NetCDF outputter. In this example, we also make use of a few utilities from the scripting package to create and clean output directories:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">gnome.model</span> <span class="k">import</span> <span class="n">Model</span>
<span class="kn">from</span> <span class="nn">gnome.outputters</span> <span class="k">import</span> <span class="n">NetCDFOutput</span>
<span class="kn">from</span> <span class="nn">gnome</span> <span class="k">import</span> <span class="n">scripting</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="k">import</span> <span class="n">timedelta</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">()</span>
<span class="n">images_dir</span> <span class="o">=</span> <span class="s1">&#39;images&#39;</span>
<span class="n">scripting</span><span class="o">.</span><span class="n">make_images_dir</span><span class="p">(</span><span class="n">images_dir</span><span class="p">)</span>
<span class="n">netcdf_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">images_dir</span><span class="p">,</span> <span class="s1">&#39;test_output.nc&#39;</span><span class="p">)</span>
<span class="n">scripting</span><span class="o">.</span><span class="n">remove_netcdf</span><span class="p">(</span><span class="n">netcdf_file</span><span class="p">)</span>
<span class="n">nc_outputter</span> <span class="o">=</span> <span class="n">NetCDFOutput</span><span class="p">(</span><span class="n">netcdf_file</span><span class="p">,</span> <span class="n">which_data</span><span class="o">=</span><span class="s1">&#39;most&#39;</span><span class="p">,</span> <span class="n">output_timestep</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">24</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">outputters</span> <span class="o">+=</span> <span class="n">nc_outputter</span>
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">which_data</span></code> specifies what data associated with the elements you want written out to the file. the options are: &#8216;standard&#8217;, &#8216;most&#8217; or &#8216;all&#8217;.</p>
<p>&#8216;standard&#8217; : the basic stuff most people would want</p>
<dl class="docutils">
<dt>&#8216;most&#8217;: everything the model is tracking except the internal-use-only</dt>
<dd>arrays</dd>
</dl>
<p>&#8216;all&#8217;: everything tracked by the model (mostly used for diagnostics)</p>
<p>in addition, you can specifically set exactly which data are output by altering the <code class="docutils literal"><span class="pre">.arrays_to_output</span></code> attribute of the outputter. It is a python set, and data array names can be added or removed before the model is run.</p>
<p>The resulting netcdf files are in the &#8220;nc_particles&#8221; format. This format allows storage of arbitrary data associated with the elements, and different numbers of elements at each timestep. Code to read this format can be found here in the GnomeTools repository on gitHub:</p>
<p><a class="reference external" href="https://github.com/NOAA-ORR-ERD/GnomeTools/blob/master/post_gnome/post_gnome/nc_particles.py">https://github.com/NOAA-ORR-ERD/GnomeTools/blob/master/post_gnome/post_gnome/nc_particles.py</a></p>
<p>See <code class="xref py py-class docutils literal"><span class="pre">gnome.outputters.NetCDFOutput</span></code> for some additional parameters that can be passed to the constructor to customize the output.</p>
</div>
<div class="section" id="kmz-output">
<h2>KMZ Output<a class="headerlink" href="#kmz-output" title="Permalink to this headline">¶</a></h2>
<p>To save particle information into a KMZ file that can be read by Google Earth (and other applications), we use the KMZ outputter:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">outputters</span> <span class="o">+=</span> <span class="n">KMZOutput</span><span class="p">(</span><span class="s1">&#39;gnome_results.kmz&#39;</span><span class="p">,</span>
                              <span class="n">output_timestep</span><span class="o">=</span><span class="n">timedelta</span><span class="p">(</span><span class="n">hours</span><span class="o">=</span><span class="mi">6</span><span class="p">))</span>
</pre></div>
</div>
<p>The KMZ contains a kml file with layers for each output timestep, unceratain and certain elements, ans beached and floating elements, along with icons to render the elements.</p>
<p>See <code class="xref py py-class docutils literal"><span class="pre">gnome.outputters.KMZOutput</span></code> for the full documentation</p>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="scripting_examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="weatherers.html" class="btn btn-neutral" title="Weatherers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2012, NOAA Emergecny Response Division.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'0.5.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>